---
layout: post
title: "거울아거울아 스터디 - 4"
author: sunyoung
description: "파이썬 데이터 분석 입문 3.1~3.6"
date: 2018-01-23
tags: [study, mirror, data]
comments: true
---
<center>
<figure>
<img src="/images/mirror-4-1.jpg" alt="views">
<figcaption>치킨은 중요해</figcaption>
</figure>
</center>

## 무엇을 배웠는가?
보람님이 [3.6장 까지의 요약](https://github.com/ramihan/analytics-with-python/blob/master/3%EC%9E%A5/3.4~3.6%EC%9A%94%EC%95%BD.md)을 준비해 주셨습니다.

### 여러 개의 통합문서 살펴보기
* 파이썬 내장 모듈 glob, os를 사용해 파일 경로와 파일명을 파싱하여 처리하려는 입력 파일 리스트를 만들고 for문을 통해 리스트를 돌며 아래의 함수들을 이용하여 각 파일의 이름, 워크시트 개수, 행/열 개수 등을 살펴볼 수 있었습니다.
* os.path.basename: 경로의 기본이름(파일명)을 반환
* book.nsheets: xlrd 패키지의 함수로 엑셀파일의 워크시트 개수를 반환
* sheet.nrows, sheet.ncols: 각각 워크시트의 행과 열의 개수를 반환하는 xlrd 패키지의 함수

### 여러 개의 통합 문서 합치기
* 팬더스 라이브러리에서 제공하는 데이터프레임 결합 함수 concat을  이용해보았습니다.
* 행 방향으로 추가하여 결합하려면 concat함수의 argument로 axis=0을 , 열 방향으로 추가하려면 axis=1을 사용해야 합니다.

### 워크시트 및 통합 문서별 통계 계산하기
* pandas.dataframe(계산하고자 하는 컬럼항목).sum() 이런식으로 팬더스에서 제공하는 기본 통계(합계, 평균 등)함수를 이용하여 워크시트 별 통계를 구할 수 있습니다.
* 각 워크시트에 대한 통계를 계산하고 그 결과를 데이터프레임으로 만들어 데이터프레임끼리 결합(merge)하면 하나의 전체 통계를 출력할 수 있습니다.

## 심화 과정에서 무엇을 배웠는가?

호성님이 [gspread](https://github.com/burnash/gspread) 라이브러리를 이용하여 구글 스프레드 시트와 파이썬 스크립트를 연동하는 것을 소개해주었습니다.

라이브러리 문서의 안내에 따라 구글 드라이브의 API 공개설정을 하고, 인증을 위한 key 파일을 생성합니다. 파일을 보면 client_email에 해당하는 이메일 계정이 있는데, 해당 스프레드시트 파일을 그 계정에 공유하면 파이썬으로 구글 스프레드를 쓸 수 있는 상태가 됩니다. 이제까지 배운 것들을 활용해 스프레드 시트의 자료들을 불러오고, 다시 쓰는 일들을 할 수 있습니다.

이렇게 파일을 연동시키고 파이썬 스크립트를 작성해 놓으면, 쿼리로 데이터를 뽑아 구글 스프레드 시트에 정리하거나 데이터 기록을 주기적으로 업데이트 하던 일들을 반자동화 할 수 있습니다.

## 어땠는가?

어느덧 책 내용의 절반을 보았습니다. 언제쯤 엑셀보다 파이썬 스크립트를 더 효율적으로 쓸 수 있을지 기대 혹은 의심하며 한 달 동안 엑셀 파일 읽고 쓰기를 연습했는데, 이제 필터링 및 간단한 계산 등을 처리할 수 있게 되었습니다. 구글 스프레드 시트와의 연동까지 알게되니 당장 실제 업무에 응용할 수 있을 것 같은 느낌적인 느낌이 듭니다!

이렇게 스터디의 절반을 성실히 참여한 게 뿌듯하고 특히 오늘 스터디에서는 참여원들의 한 단계 성장한 모습이 보여 즐거웠습니다. 모르는 내용에 대해 호성님 대신 대답해 줄 수 있는 실력을 갖추게 되었고, 코드의 readability에 대해 논할 수 있는 수준이 되었습니다. 다들 열심히 참여해주셔서 자극도 많이 되고 든든합니다. 다음 주 해커톤도 즐거운 경험이 되길 기대해봅니다.
